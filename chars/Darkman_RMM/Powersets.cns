;===========================================================================
;Robot Master Mayhem - Constants Template (Power Sets) V.1
;Template by Acey
;Based on Megaman by Chaotic
;www.infinitymugenteam.com
;===========================================================================

;---------------------------------------------------------------------
;The Power Set choser (statedef 1200) is found in Toadman.CNS
;
;Power Sets (1201 - 1208, 1500)
;Power Set Helpers (1501-1502, 6000 - 6050)
;---------------------------------------------------------------------

;---------------------------------------------------------------------------------------------
;Change Power Set (0 through 6)
[Statedef 2000]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 2000

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 3
value = S1500,1
volume = 0
channel = -1
freqmul = 1.0
loop = 0
pan = 0
persistent = 0

[State 0, Explod]
type = Explod
trigger1 = animelem = 3;time = 39
anim = 25080
ID =  25080
pos = 10,-70
postype = p1
facing = 1
vfacing = 1
bindtime = -1
vel = 0,0
accel = 0,0
random = 0,0
removetime = -2
scale = 1,1
sprpriority = 0
ontop = 1
shadow = 0,0,0
ownpal = 1
removeongethit = 1

[State 0, Helper]
type = Helper
triggerall = numexplod(8300) = 0
trigger1 = animelem = 3
helpertype = normal ;player
name = "BossName"
ID =  8300
stateno = 8300
pos = 15,-85
postype = p1    ;p2,front,back,left,right
supermovetime = 99999999
pausemovetime = 99999999
persistent = 0

[State 0, VarSet]
type = VarSet
trigger1 = animelem = 1 && var(25) = 0
v = 35
value = 0

[State 0, VarSet]
type = VarSet
trigger1 = animelem = 1 && var(25) = 1
v = 35
value = 1

[State 0, VarSet]
type = VarSet
trigger1 = animelem = 1 && var(25) = 2
v = 35
value = 2

[State 0, VarSet]
type = VarSet
trigger1 = animelem = 1 && var(25) = 3
v = 35
value = 3

[State 0, VarSet]
type = VarSet
trigger1 = animelem = 1 && var(25) = 4
v = 35
value = 4

[State 0, VarSet]
type = VarSet
trigger1 = animelem = 1 && var(25) = 5
v = 35
value = 5

[State 0, VarSet]
type = VarSet
trigger1 = animelem = 1 && var(25) = 6
v = 35
value = 6

[State 1112, ChangeState]
type = ChangeState
trigger1 = !AnimTime
value = ifelse(var(16)=0,0,50)
ctrl = 1


;---------------------------------------------------------------------------------------------
;PS1 - Dark net
[Statedef 2100]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 2100 + (pos Y < 0)
velset = 0,0
poweradd = 50

[State 0, ChangeState]
type = ChangeState
triggerall = Ailevel
trigger1 = !time && var(35) = 4
value = 2400
ctrl = 0

[State 0, ChangeState]
type = ChangeState
triggerall = Ailevel
trigger1 = !time && var(35) = 1
trigger1 = NumHelper(2105)=1
value = ifelse(random<500,80,100);ifelse(random<300,100,ifelse(random>600,105,1100))
ctrl = 0

[State 0, Strenght Variable]
type = VarSet
trigger1 = !time 
v = 4 
value = ifelse(command = "QCFc",3,ifelse(command = "QCFb",2,1))

[State 0, Strenght Variable]
type = VarSet
trigger1 = !time && AiLevel
v = 4 
value = 1+random%3

[State 1204, PlaySnd]
type = PlaySnd
trigger1 = animelem = 1
value = S2100,0+random%2

[State 0, VelSet]
type = VelSet
trigger1 = animelem = 3
x = -3

[State 1204, PlaySnd]
type = PlaySnd
trigger1 = animelem = 3
value = S2105,0

[State 0, Helper]
type = Helper
trigger1 = animelem = 3
helpertype = normal
name = "Dark Net"  ;Bubble
ID =  2105
stateno = 2105
pos = 41,-40
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1

[State 0, Explod]
type = Explod
trigger1 = !time && Pos Y = 0
anim = 6012
ID = 6012
pos = -30,10
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = -0.2,0
random = 0,0
removetime = -2
pausemovetime = 0
scale = 1,1
sprpriority = 30
ontop = 0
shadow = 0,0,0
ownpal = 1
removeongethit = 0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Pos Y < 0
statetype = A 

[State 1112, ChangeState]
type = ChangeState
trigger1 = !AnimTime
value = 50
ctrl = 0

;---------------------------------------------------------------------------
;Dark Net helper
[statedef 2105]
type = A
movetype = A
physics = N
ctrl = 0
poweradd = 20
anim = 2105
sprpriority = 50
juggle = 0

[State 820, 1]
type = velset
trigger1 = !time
x= root, var(4)

[State 820, 1]
type = velset
trigger1 = 1
y = sin(time*25)

[State 0, Explod]
type = Explod
trigger1 = time%16=0
anim = 2105
pos = 0,0
postype = p1  ;p2,front,back,left,right
facing = 1
vel = 0,0;0.25
accel = -0.01,0;-0.03
random = 40,40
removetime=40
scale = .15,.15
sprpriority = 18
ownpal = 1

[State 7001, 2]
type = HitDef
trigger1 = !time
attr = A, SP
damage = 0, 0
animtype = light
air.animtype = back
hitflag = MAF
guardflag = MA
fall = 1
air.fall = 1
pausetime = 0,11
guard.pausetime = 0,11
sparkno = s8111
sparkxy = 15,0
hitsound = s2105,1
guard.sparkno= S25008
guardsound = s8500,0
ground.type = low
ground.slidetime = 9
ground.hittime  = 9
guard.slidetime = 7
guard.hittime = 7
ground.velocity = -5,-2
airguard.velocity = -3,-2
guard.velocity = -8
airguard.velocity = -3,-2
air.type = low
air.velocity = -5,-2
air.hittime = 9
getpower = 50,50
sprpriority = 1
fall.recovertime = 8
yaccel = .45
fall.yvelocity = -4
p1stateno = 2106
p2stateno = 2107
p2facing = 1



[State 0, ChangeState]
type = ChangeState
trigger1 = FrontEdgeDist < -40
trigger2 = MoveGuarded
value = 2108

;---------------------------------------------------------------------------
;Dark Net hit
[statedef 2106]
type = S
movetype = A
physics = N
ctrl = 0
poweradd = 20
anim = 2106
velset = 1,-0.5
sprpriority = 50


[State 0, PosAdd]
type = PosAdd
trigger1 = !time
trigger1 = FrontEdgeDist > 40
x = 30

[State 0, PosSet]
type = PosSet
trigger1 = !time
y = 0
ignorehitpause = 1

[State 820, 1]
type = PosAdd
trigger1 = 1
y = -sin(time*25)

[State 0, VelSet]
type = VelSet
trigger1 = FrontEdgeDist < 20
x = 0
y = 0

[State 8034, VarSet]
Type = VarSet
Trigger1 = NumTarget > 0
Trigger1 = Time = 0
FV = 0
Value = ((Target,Const(Size.Ground.Back))+(Target,Const(Size.Ground.Front)))/123.0

[State 8034, VarSet 2]
Type = VarSet
Trigger1 = NumTarget > 0
Trigger1 = Time = 0
FV = 1
Value = (Target,Const(Size.Height))/134.0

[State 8034, AngleDraw]
Type = AngleDraw
Trigger1 = 1
Value = 0
Scale = (1*FVar(0))+1.3,(1*FVar(1))+1.2

[State 0, TargetBind]
type = TargetBind
trigger1 = 1
time = 1
pos = 0,-10

[State 0, NotHitBy]
type = NotHitBy
trigger1 =  1
value = SCA
time = 1

[State 0, PalFXWiz]
type = PalFX
trigger1 = time=90
time = 60
add = 200,80,-250
mul = 256,256,256
sinadd = 29,200,200,4
invertall = 0
color = 256

[State 0, ChangeState]
type = ChangeState
trigger1 = time = 120
trigger2 = NumTarget && Target, Stateno !=2107
value = 2108
ctrl = 0

;---------------------------------------------------------------------------
;Dark Net Custom
[statedef 2107]
type = A
movetype = H
physics = N
ctrl = 0
poweradd = 20
anim = 5010

[State 0, SelfState]
type = SelfState
trigger1 = time = 120
value = 5050


;---------------------------------------------------------------------------
;Dark Net Destroy
[statedef 2108]
type = S
movetype = A
physics = N
ctrl = 0
poweradd = 20
anim = 2105
velset = 0,0
sprpriority = 50
juggle = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S1,4

[State 0, PosAdd]
type = PosAdd
trigger1 = !time
y = -30

[State 0, DestroySelf]
type = DestroySelf
trigger1 = !AnimTime


;---------------------------------------------------------------------------------------------
;PS2 - Tank Mode start
[Statedef 2200]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 2200
velset = 0,0
poweradd = 50

[State 0, Strenght Variable]
type = VarSet
trigger1 = !time 
v = 4 
value = ifelse(command = "QCFc", 10, ifelse(command = "QCFb", 6, 2))

;Sets var(57) to 1, meaning the remappal in -2 states will change palette to green dark man (#1)
[State 0, VarSet]
type = VarSet
triggerall = var(57) != 1
trigger1 = anim = 2200 && animelem = 2
v = 57
value = 1

;White blink to make the color change smoother and not look sudden
[State 632, 1]
type = palfx
trigger1 = AnimElem = 2
time = 16
sinadd =  255,255,255,30
ignorehitpause = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = AnimElem = 2
statetype = A
physics = N

[State 0, VelSet]
type = VelSet
trigger1 = AnimElem = 2
x = var(4)+2
y = -8 - (var(4) / 3)



[State 632, 1]
type = palfx
trigger1 = AnimElem = 2
time = 15
sinadd =  255,255,255,30
ignorehitpause = 1

[State 0, Explod]
type = Explod
trigger1 = !time && Pos Y =0
anim = 6011
ID = 6011
pos = 30,10
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = 0.2,0
random = 0,0
removetime = -2
pausemovetime = 0
scale = 1,1
sprpriority = 30
ontop = 0
shadow = 0,0,0
ownpal = 1
removeongethit = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 2
value = S0,3

[State 0, ChangeState]
type = ChangeState
trigger1 = !AnimTime
value = 2201
ctrl = 0

;---------------------------------------------------------------------------------------------
;PS2 - Tank Mode start
[Statedef 2201]
type    = A
movetype= A
physics = N
ctrl = 0
anim = 2201
velset = 0,0
poweradd = 50

[State 1300, Width]
type = Width
trigger1 = animelemtime(2) >= 0 && animelemtime(3) < 0
edge = 17, 10
player = 20, 10

[State 1300, Width]
type = Width
trigger1 = animelemtime(3) >= 0 && animelemtime(5) < 0
edge = 25, 10
player = 30, 10

[State 1300, PlayerPush]
type = PlayerPush
trigger1 = animelemtime(2) > 0
value = 0

[State 1300, VelSet]
type = VelSet
trigger1 = animelemtime(2) > 0 && animelemtime(2) <= 2
y = 6

[State 1300, VelSet]
type = VelAdd
trigger1 = animelemtime(2) > 2
y = .9

[State 1300, HitDef]
type = HitDef
trigger1 = time = 0
ID = 2200
attr = A, SA
damage = 25, 7
animtype = Hard
guardflag = HA
hitflag = MAFD
priority = 4, Hit
pausetime = 12, 12
sparkno = S25010 + random % 2;0
guard.sparkno= S25008
sparkxy = -10, -0
hitsound = s8000, 5
guardsound = s8500, 0
; The rest of the hitdef now actually matters a bit in case opponent blocks, but if hit i'm going to a target state
ground.type = High
ground.slidetime = 18
ground.hittime = 18
guard.velocity = -5
air.type = High
air.hittime = 18
air.velocity = 0, -3
airguard.velocity = -2, -3
fall = 1
fall.recover = 0
fall.envshake.time = 15
fall.envshake.ampl = -7

[State 1300, End]
type = targetstate
Triggerall = NumTarget
trigger1 = movehit && !(Target, IsHelper)
ID = 2200
value = 2230

[State 1300, ChangeState]
type = ChangeState
trigger1 = Movehit && !(NumTarget(2200) <= 0)
value = 2210

[State 1300, ChangeState]
type = ChangeState
trigger1 = animelemtime(2) > 2 && pos y > -9
value = 2205

;-----------------------------------------------------------------------------
; Dark "semple" tank drop: land part (Missed)
[Statedef 2205]
type    = S
movetype= I
physics = S
ctrl = 0
anim =  2205
velset = 0,0

[State 1305, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S1300,0

[State 1305, EnvShake]
type = EnvShake
trigger1 = !time
time = 20
freq = 60
ampl = -5

[State 1305, VelSet]
type = PosSet
trigger1 = !time
y = 0

[State 0, Helper]
type = Helper
trigger1 = !time
helpertype = normal ;player
name = "boulder"
ID = 1621
stateno = 1622
pos = 0,0
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1
supermovetime = 0
pausemovetime = 0

[State 0, Explod]
type = Explod
trigger1 = !time
anim = 2250
ID = 2250
pos = 0,0
postype = P1  ;P2, Front, Back, Left, Right
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = 0,0
random = 0,0
removetime = -2
supermovetime = 0
pausemovetime = 0
scale = 1,1
sprpriority = -5
ontop = 0
shadow = 0,0,0
ownpal = 1
removeongethit = 0

;Resets var(57) to 0, making remappal in -2 states change back to player selected palette
[State 0, VarSet]
type = VarSet
triggerall = var(57) != 0
trigger1 = animelemtime(2) >= 0 && animelemtime(4) < 0 
v = 57
value = 0

;White blink to make the color change smoother and not look sudden
[State 632, 1]
type = palfx
trigger1 = animelem = 2 
time = 16
sinadd =  255,255,255,30
ignorehitpause = 1

[State 1305, ChangeState]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1

;-----------------------------------------------------------------------------
; Dark "semple" tank drop: falling down (Move Hit)
[Statedef 2210]
type    = A
movetype= A
physics = N
anim = 2210
ctrl = 0

[State 0, TargetFacing]
type = TargetFacing
trigger1 = facing = enemynear, facing
value = facing * -1
ID = 2200

[State 1310, TargetBind]
type = TargetBind
trigger1 = 1
pos = 0, -17

[State 1310, VelSet]
type = VelAdd
trigger1 = 1
y = .9

[State 0, ChangeState]
type = ChangeState
trigger1 = pos y > -9
value = 2215

;-----------------------------------------------------------------------------
; Dark "semple" tank drop: land part (Hit)
[Statedef 2215]
type    = S
movetype= A
physics = N
ctrl = 0
anim =  2215
velset = 0,0

[State 1315, Throw]
type = TargetState
trigger1 = !time
value = 2235

[State 1315, TargetLifeAdd]
type = TargetLifeAdd
trigger1 = !time
value = ceil(-60 * fvar(10))

[State 1315, HitAdd]
type = HitAdd
trigger1 = !time
value = 1

[State 1315, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S1300,0

[State 1315, EnvShake]
type = EnvShake
trigger1 = !time
time = 20
freq = 60
ampl = -5

[State 1315, VelSet]
type = PosSet
trigger1 = !time
y = 0

[State 0, Helper]
type = Helper
trigger1 = !time
helpertype = normal ;player
name = "boulder"
ID = 1621
stateno = 1622
pos = 0,0
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1
supermovetime = 0
pausemovetime = 0

[State 40]
type = Explod
trigger1 = !time
ID = 25020
anim = 25010+random%2
sprpriority = 2
Ownpal = 1
Pos = -10, 0
postype = P2  ;P2, Front, Back, Left, Right
removetime = -2
ignorehitpause = 1

[State 1350, Explod]
type = Explod
trigger1 = !time
anim = 2250
ID = 2250
pos = 0,0
postype = P1  ;P2, Front, Back, Left, Right
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
scale = 1,1
sprpriority = -5
ontop = 0
ownpal = 1
removeongethit = 0

[State 1315, TargetBind]
type = TargetBind
trigger1 = anim = 2215
trigger1 = AnimElemtime(1) >= 0 && AnimElemtime(2) < 0
pos = 0, 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = anim = 2215
trigger1 = p2bodydist x > 60 || p2bodydist x < -60
value = 2220

[State 200, PlaySnd]
type = PlaySnd
trigger1 = anim = 2215
trigger1 = AnimElem = 2
value = s1300, 1
channel = -1

[State 0, VelSet]
type = VelSet
trigger1 = anim = 2215
trigger1 = animelem = 2
trigger2 = anim = 2220
trigger2 = animelem = 1
x = ifelse(anim = 2215, 3 * ifelse(frontedgedist < 60, -1, 1), 0)

;Resets var(57) to 0, making remappal in -2 states change back to player selected palette
[State 0, VarSet]
type = VarSet
triggerall = var(57) != 0
trigger1 = anim = 2220 && animelem = 2
v = 57
value = 0

;White blink to make the color change smoother and not look sudden
[State 632, 1]
type = palfx
trigger1 = anim = 2220 && animelem = 2
time = 16
sinadd =  255,255,255,30
ignorehitpause = 1

[State 1315, ChangeState]
type = ChangeState
trigger1 = animtime = 0
trigger1 = anim = 2220
value = 0
ctrl = 1

;-----------------------------------------------------------------------------
; Dark "semple" tank drop: falling (Custom hit state)
[Statedef 2230]
type    = A
movetype= H
physics = N
ctrl = 0

[State 0, ChangeAnim]
type = ChangeAnim2
trigger1 = !time
value = 2230

[State 820, 2]
type = SelfState
trigger1 = !gethitvar(isbound)
value = 5050

;-----------------------------------------------------------------------------
; Dark "semple" tank drop: Lie down (Custom hit state)
[Statedef 2235]
type    = L
movetype= H
physics = N
ctrl = 0

[State 0, VelSet]
type = PosSet
trigger1 = !time
y = 0

[State 0, ChangeAnim]
type = ChangeAnim2
trigger1 = !time
value = 2235

[State 0, SelfState]
type = SelfState
trigger1 = time > 70
value = 5110

;---------------------------------------------------------------------------------------------
;PS3 - Shooter Mode start
[Statedef 2300]
type    = S
movetype= A
physics = N
ctrl = 0
velset = 0,0
poweradd = 50

[State 0, Strenght Variable]
type = VarSet
trigger1 = !time 
v = 4 
value = ifelse(command = "QCFc",2,ifelse(command = "QCFb",1,0))

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 2300+var(4)

;Sets var(57) to 3, meaning the remappal in -2 states will change palette to purple dark man (#3)
[State 0, VarSet]
type = VarSet
trigger1 = var(57) != 3
trigger1 = animelem = 2
v = 57
value = 3

;Resets var(57) to 0, making remappal in -2 states change back to player selected palette
[State 0, VarSet]
type = VarSet
trigger1 = var(57) != 0
trigger1 = !AnimTime
v = 57
value = 0

;White blink to make the color change smoother and not look sudden
[State 632, 1]
type = palfx
trigger1 = AnimElem = 2
trigger2 = !AnimTime
time = 16
sinadd =  255,255,255,30
ignorehitpause = 1

[State 0, Explod]
type = Explod
trigger1 = !time && Pos Y =0
anim = 6011
ID = 6011
pos = 30,10
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = 0.2,0
random = 0,0
removetime = -2
pausemovetime = 0
scale = 1,1
sprpriority = 30
ontop = 0
shadow = 0,0,0
ownpal = 1
removeongethit = 0

[State 0, VelSet]
type = VelSet
trigger1 = AnimElem = 2
x = -6
y = -6

[State 0, VelAdd]
type = VelAdd
trigger1 = Pos Y < 0
y = 0.25

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Pos Y < 0
statetype = A       ;S,A,C,L

[State 0, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 2
value = S0,3

[State 0, Helper]
type = Helper
trigger1 = AnimElem = 5
helpertype = Normal ;Player
name = "Proj"
ID = 2305
stateno = 2305 
pos = 37,-43
postype = P1    ;P2, Front, Back, Left, Right
facing = 1
keyctrl = 0
ownpal = 1

[State 0, Helper]
type = Helper
triggerall = anim != 2300
trigger1 = AnimElem = 7
helpertype = Normal ;Player
name = "Proj"
ID = 2306
stateno = 2305 
pos = 42,-49
postype = P1    ;P2, Front, Back, Left, Right
facing = 1
keyctrl = 0
ownpal = 1

[State 0, Helper]
type = Helper
triggerall = anim = 2302
trigger1 = AnimElem = 9
helpertype = Normal ;Player
name = "Proj"
ID = 2307
stateno = 2305 
pos = 47,-60
postype = P1    ;P2, Front, Back, Left, Right
facing = 1
keyctrl = 0
ownpal = 1


[State 0, ChangeState]
type = ChangeState
trigger1 = !AnimTime
value = 50
ctrl = 0

;---------------------------------------------------------------------------------------------
;PS3 - Shooter Proj
[Statedef 2305]
type    = A
movetype= A
physics = N
ctrl = 0
anim = 2305

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S2300,0

[State 0, VelSet]
type = VelSet
trigger1 = !time
x = 3
y = ifelse(IsHelper(2305),3,ifelse(IsHelper(2306),2,1.5))

[State 195,1]
type = Explod
trigger1 = time%6=0;&& time <60
anim = 503+random%3
postype = p1
pos = 0,0
ownpal = 1
bindtime = 1
sprpriority = 5
removetime = -2
random = 15,15
removeongethit = 1
scale = 1,1



[State 0, HitDef]
type = HitDef
trigger1 = !time
attr = A,SP
damage = ceil(40 * root, fvar(10)),2
animtype = hard
guardflag = MA
hitflag = MAFD
priority = 4, Hit
pausetime = 3,15
sparkno = S25010+random%2
sparkxy = 0,0
hitsound = s8000,2
guard.sparkno = S25008
guardsound = s8500,0
guardsound = s8500,0
ground.type = High
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = -10
air.type = High
air.hittime = 18
air.velocity = -6,-3
air.animtype = Heavy
palfx.time = 40
palfx.add = 75,25,95
palfx.mul = 170,80,210
palfx.sinadd = 40,10,50,5
palfx.color = 0;
envshake.time = 10
envshake.ampl = 7
fall = 1
fall.recover = 0
ID= 2305
NoChainID = 2305
air.juggle = 5

[state 1150, SHOCK FX]
type = explod
triggerall = NumTarget
trigger1 = numexplod(428) = 0
trigger1 = movehit && target, MoveType = H && target, StateType != L
anim = 428
id = 428
pos = Floor(enemynear, const(size.mid.pos.x)),Floor(enemynear, const(size.mid.pos.y))
postype = p2
removetime = 20
sprpriority = 10
bindtime = -1
ownpal = 1
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = NoShadow
ignorehitpause = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NT,ST,HT
time = 1
ignorehitpause = 1

[State 1005, 5.1]
type = HitBy
trigger1 = 1
value = SCA,AP

[State 1005, 5.2]
type = HitOverride
trigger1 = !(Time)
slot = 0
time = -1
attr = SCA,AA,AT,AP
stateno = 2310


[State 0, ChangeState]
type = ChangeState
trigger1 = FrontEdgeDist < -40
trigger2 = MoveContact
trigger3 = Pos Y >=0
value = 2310

;---------------------------------------------------------------------------------------------
;PS3 - Shooter Proj end
[Statedef 2310]
type    = A
movetype= A
physics = N
ctrl = 0
anim = 2310
velset = 0,0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Pos Y >=0
value = S2,1
persistent = 0


[State 0, DestroySelf]
type = DestroySelf
trigger1 = !AnimTime 
;ignorehitpause = 
;persistent = 

;---------------------------------------------------------------------------------------------
;PS4 - Proto Mode start
[Statedef 2400]
type    = S
movetype= A
physics = N
ctrl = 0
anim = 2400
velset = 0,0
poweradd = 50

[State 0, Strenght Variable]
type = VarSet
triggerall = !Ailevel
trigger1 = !time 
v = 4 
value = ifelse(command = "QCFc",-4,ifelse(command = "QCFb",-2,0))

[State 0, Strenght Variable]
type = VarSet
triggerall = Ailevel
trigger1 = !time 
v = 4 
value = ifelse(random<250,-2,0)

[State 0, VelSet]
type = VelSet
trigger1 = AnimElem = 3
x = 12
y = var(4)

[State 0, Explod]
type = Explod
trigger1 = AnimElem = 3
anim = 8661
ID = 8660
pos = 20,0
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = 0,0
random = 0,0
removetime = -2
pausemovetime = 9999
scale = 1,1
sprpriority = 20
ontop = 0
shadow = 0,0,0
ownpal = 1
removeongethit = 1

;Sets var(57) to 5, meaning the remappal in -2 states will change palette to protoman colors
[State 0, varSet]
type = varSet
trigger1 = var(57) != 5
trigger1 = animelem = 2
v = 57
value = 5

;White blink to make the color change smoother and not look sudden
[State 632, 1]
type = palfx
trigger1 = AnimElem = 2
time = 16
sinadd =  255,255,255,30
ignorehitpause = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S3,8+random%3


[State 0, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 3
value = S0,5

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Pos Y < 0
statetype = A       ;S,A,C,L

[State 0, Explod]
type = Explod
trigger1 = !time && Pos Y = 0
anim = 6012
ID = 6012
pos = -30,10
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = -0.2,0
random = 0,0
removetime = -2
pausemovetime = 0
scale = 1,1
sprpriority = 30
ontop = 0
shadow = 0,0,0
ownpal = 1
removeongethit = 0

[State 250, HitDef]
type = HitDef
trigger1 = !time
attr = S,SA
damage = 100+var(4),1
animtype = Hard
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 4,4
sparkno = S25010+random%2;0
sparkxy = -10, -40
guard.sparkno= S25008
hitsound = s8000,2
guardsound = s8500,0
ground.type = Trip
ground.slidetime = 12
ground.hittime = 12
ground.velocity = 0,-8
air.type = Trip
air.hittime = 5
air.velocity = -1,10
fall = 1
envshake.time = 15
envshake.ampl = 10

[State 100, New Dash start fx]
type = Explod
trigger1 = !time && Pos Y = 0
ID = 6088
anim = 6088
postype = p1
pos = 10,0
bindtime = 1
removetime = -2
vel = 0, 0
ownpal = 1
sprpriority = 5
removeongethit = 0

[State 100, NEW DASH FX FWD]
type = Explod
Anim = 25017+random%2;ifelse(random >=500,8050,8051)
triggerall = vel X > 0
trigger1 = random < 400 
postype = P1
pos = 0,-45
random = 10,45
ownpal = 1
scale = (ifelse(random <=500,1,0.5)),(ifelse(random <=500,1,0.5))
sprpriority = (ifelse(random <=500,10,-10))
vel = -(const(velocity.run.fwd.x)/2)

[State 0, ChangeState]
type = ChangeState
trigger1 = Time = 40 
value = 2405
ctrl = 0

;---------------------------------------------------------------------------------------------
;PS4 - Proto Mode End
[Statedef 2405]
type    = A
movetype= A
physics = A
ctrl = 0
anim = 2405

;Resets var(57) to 0, making remappal in -2 states change back to player selected palette
[State 0, RemapPal]
type = varSet
trigger1 = var(57) != 0
trigger1 = !time
v = 57
value = 0

;White blink to make the color change smoother and not look sudden
[State 632, 1]
type = palfx
trigger1 = !time
time = 16
sinadd =  255,255,255,30
ignorehitpause = 1

[State 0, Gravity]
type = Gravity
trigger1 = 1

;---------------------------------------------------------------------------------------------
;PS5 - Shield Mode start
[Statedef 2500]
type    = S
movetype= A
physics = N
ctrl = 0
anim = 2000
velset = 0,0
poweradd = 50

[State 0, Strenght Variable]
type = VarSet
trigger1 = !time 
fv = 4 
value = ifelse(command = "QCFc",25.0,ifelse(command = "QCFb",50.0,75.0))

[State 0, Helper]
type = Helper
trigger1 = AnimElem=1
helpertype = normal
name = "Shield root"  ;Bubble
ID =  2501
stateno = 2501
pos = 0,0
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S2500,random%2

;Sets var(57) to 2, meaning the remappal in -2 states will change palette to grey dark man (#2)
[State 0, VarSet]
type = VarSet
trigger1 = var(57) != 2
trigger1 = animelem = 3
v = 57
value = 2

;Resets var(57) to 0, making remappal in -2 states change back to player selected palette
[State 0, VarSet]
type = VarSet
triggerall = var(57) != 0
trigger1 = !animtime
v = 57
value = 0

;White blink to make the color change smoother and not look sudden
[State 632, 1]
type = palfx
trigger1 = AnimElem = 2
trigger2 = !AnimTime
time = 16
sinadd =  255,255,255,30
ignorehitpause = 1

[State 0, Explod]
type = Explod
trigger1 = !time && Pos Y =0
anim = 6011
ID = 6011
pos = 30,10
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = 0.2,0
random = 0,0
removetime = -2
pausemovetime = 0
scale = 1,1
sprpriority = 30
ontop = 0
shadow = 0,0,0
ownpal = 1
removeongethit = 0


[State 0, ChangeState]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Shield - mother helper
[statedef 2501]
type = A
movetype = A
physics = N
ctrl = 0
poweradd = 20
anim = 9999
velset = 0,0
sprpriority = 50

[State 1145, 1]
type = BindToRoot
trigger1 = 1;
pos = 0,0; ifelse(root, Statetype=C,0,-15)
time = -1
ignorehitpause = 1

[State 0, Helper]
type = Helper
trigger1 = !time
helpertype = normal ;player
name = "Shield"
ID = 2505
stateno = 2505
pos = 30,5
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1
pausemovetime = 9999
supermovetime = 9999

[State 0, Helper]
type = Helper
trigger1 = !time
helpertype = normal ;player
name = "Shield"
ID = 2506
stateno = 2505
pos =-30,-5
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1
pausemovetime = 9999
supermovetime = 9999

[State 0, DestroySelf]
type = ChangeState
trigger1 = (root, NumHelper(2505)=0)
trigger1 = (root, NumHelper(2506)=0)
trigger2 = Time = 360
value = 2502

;---------------------------------------------------------------------------
;Shield - mother helper end
[statedef 2502]
type = A
movetype = A
physics = N
ctrl = 0
poweradd = 20
anim = 9999
velset = 0,0

[State 0, DestroySelf]
type = DestroySelf
trigger1 = !time

 
;---------------------------------------------------------------------------
;Shield - helper
[statedef 2505]
type = A
movetype = A
physics = N
ctrl = 0
anim = 2505
poweradd = 20
velset = 0,0
juggle = 10

[State 0, SprPriority]
type = SprPriority
trigger1 = 1 
value = ifelse(IsHelper(2506),-5,5)

[State 0, VarSet]
type = VarSet
trigger1 = 1
v = 10    ;fv = 10
value = parent,time

[State 0, VarSet]
type = VarSet
trigger1 = !time && !fvar(4)
fv = 4
value = root,fvar(4)
ignorehitpause = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time && PrevStateno != 2505
value = S19100,3

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = NoShadow
ignorehitpause = 1

[State 1154, 1]
type = BindToParent
triggerall = IsHelper(2505)
trigger1 = 1
pos = cos((var(10))/fvar(4)*pi)*50,2
time = -1
ignorehitpause = 1

[State 1154, 1]
type = BindToParent
triggerall = IsHelper(2506)
trigger1 = 1
pos = -cos((var(10))/fvar(4)*pi)*50,2
time = -1
ignorehitpause = 1

[State 0, HitDef]
type = HitDef
trigger1 = anim = 2505;!time
attr = A,SA
damage = ceil(20 * root, fvar(10)),2
animtype = hard
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 0,15
sparkno = S25010+random%2
sparkxy = 0,-50
hitsound = s8000,2
guard.sparkno = S25008
guardsound = s8500,0
guardsound = s8500,0
ground.type = High
ground.slidetime = 18
ground.hittime  = 18
guard.slidetime = 5
guard.hittime  = 5
ground.velocity = -10
air.type = High
air.hittime = 18
airguard.hittime = 5
air.velocity = -6,-3
air.animtype = Heavy
palfx.time = 40
palfx.add = 100,100,250
palfx.mul = 200,200,256
palfx.sinadd = -100,-100,-80,4
palfx.color = 0;
envshake.time = 10
envshake.ampl = 7
fall = 1
fall.recover = 0
ID= 2305
NoChainID = 2305
air.juggle = 5

[state 1150, SHOCK FX]
type = explod
triggerall = NumTarget
trigger1 = numexplod(427) = 0
trigger1 = movehit && target, MoveType = H && target, StateType != L
anim = 427
id = 427
pos = Floor(enemynear, const(size.mid.pos.x)),Floor(enemynear, const(size.mid.pos.y))
postype = p2
removetime = 20
sprpriority = 10
bindtime = -1
ownpal = 1
ignorehitpause = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NT,ST,HT
time = 1
ignorehitpause = 1

[State 1005, 5.1]
type = HitBy
trigger1 = 1
value = SCA,AP

[State 1005, 5.2]
type = HitOverride
trigger1 = !(Time)
slot = 0
time = -1
attr = SCA,AA,AT,AP
stateno = 2505
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = MoveContact;Movehit
value = 2505
ctrl = 0
ignorehitpause

[State 0, ChangeState]
type = ChangeState
trigger1 = root, stateno = 2000
trigger2 = root, stateno = [3000,4999]
trigger3 = parent, stateno = 2502
value = 2510
ctrl = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = Root, stateno = 2520
value = 2525
ctrl = 0



;---------------------------------------------------------------------------
;Shield - Remove
[statedef 2510]
type = A
movetype = A
physics = N
ctrl = 0
poweradd = 20
anim = 9999
velset = 0,0

[State 0, Explod]
type = Explod
trigger1 = !time
anim = 2510
ID = 2510
pos = 0,0
postype = P1  ;P2, Front, Back, Left, Right
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = 0,0
random = 0,0
removetime = -2
supermovetime = 0
pausemovetime = 0
scale = 1,1
sprpriority = 0
ontop = 0
shadow = 0,0,0
ownpal = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S19100,2

[State 0, DestroySelf]
type = DestroySelf
trigger1 = !time

;---------------------------------------------------------------------------------------------
;PS5 - Shield Throw
[Statedef 2520]
type    = S
movetype= A
physics = N
ctrl = 0
anim = 2520
velset = 0,0
poweradd = 50

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S0,5

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S3,11+random%2

;Sets var(57) to 2, meaning the remappal in -2 states will change palette to grey dark man (#2)
[State 0, VarSet]
type = VarSet
trigger1 = var(57) != 2
trigger1 = animelem = 3
v = 57
value = 2

;Resets var(57) to 0, making remappal in -2 states change back to player selected palette
[State 0, VarSet]
type = VarSet
triggerall = var(57) != 0
trigger1 = !animtime
v = 57
value = 0

;White blink to make the color change smoother and not look sudden
[State 632, 1]
type = palfx
trigger1 = AnimElem = 2
trigger2 = !AnimTime
time = 16
sinadd =  255,255,255,30
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = !AnimTime 
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Shield - helper throw
[statedef 2525]
type = A
movetype = A
physics = N
ctrl = 0
poweradd = 20
anim = 2505

[State 0, VarSet]
type = VarSet
trigger1 = !time
fv = 4    
value = ifelse(root,fvar(4)=25.0,6,ifelse(root,fvar(4)=50.0,9,12))

[State 0, BindToParent]
type = BindToParent
trigger1 = !time
time = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = NoShadow
ignorehitpause = 1

[State 0, VelSet]
type = VelSet
trigger1 = !time
x = ifelse(ParentDist X > 0, fvar(4),-fvar(4))

[State 0, HitDef]
type = HitDef
trigger1 = !time
attr = A,SA
damage = 40,2
animtype = hard
guardflag = MA
hitflag = MAFD
priority = 4, Hit
pausetime = 0,15
sparkno = S25010+random%2
sparkxy = 0,-50
hitsound = s8000,2
guard.sparkno = S25008
guardsound = s8500,0
guardsound = s8500,0
ground.type = High
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = -10
air.type = High
air.hittime = 18
air.velocity = -6,-3
air.animtype = Heavy
palfx.time = 40
palfx.add = 100,100,250
palfx.mul = 200,200,256
palfx.sinadd = -100,-100,-80,4
palfx.color = 0;
envshake.time = 10
envshake.ampl = 7
fall = 1
fall.recover = 0
ID= 2305
NoChainID = 2305
air.juggle = 5

[state 1150, SHOCK FX]
type = explod
triggerall = NumTarget
trigger1 = numexplod(427) = 0
trigger1 = movehit && target, MoveType = H && target, StateType != L
anim = 427
id = 427
pos = Floor(enemynear, const(size.mid.pos.x)),Floor(enemynear, const(size.mid.pos.y))
postype = p2
removetime = 20
sprpriority = 10
bindtime = -1
ownpal = 1
ignorehitpause = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NT,ST,HT
time = 1
ignorehitpause = 1

[State 1005, 5.1]
type = HitBy
trigger1 = 1
value = SCA,AP

[State 1005, 5.2]
type = HitOverride
trigger1 = !(Time)
slot = 0
time = -1
attr = SCA,AA,AT,AP
stateno = 2525
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = FrontEdgeDist < -40
trigger2 = BackEdgeDist < -40
trigger3 = time = 80
;ignorehitpause = 
;persistent = 

;---------------------------------------------------------------------------------------------
;PS6 - Bat Mode
[Statedef 2600]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 2600
velset = 0,0
poweradd = 50

[State 0, Strenght Variable]
type = VarSet
trigger1 = !time 
v = 4 
value = ifelse(command = "QCFc", 2, ifelse(command = "QCFb", 1, 0))

[State 0, Explod]
type = Explod
trigger1 = !time && Pos Y = 0
anim = 6012
ID = 6012
pos = -30,10
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = -0.2,0
random = 0,0
removetime = -2
pausemovetime = 0
scale = 1,1
sprpriority = 30
ontop = 0
shadow = 0,0,0
ownpal = 1
removeongethit = 0

[State 0, Helper]
type = Helper
trigger1 = animelem = 3
helpertype = normal
name = "Dark Portal"  ;Bubble
ID =  2605
stateno = 2605
pos = 0,-160
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S2600,random%2


[State 0, ChangeState]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1

;---------------------------------------------------------------------------------------------
;PS6 - Portal
[Statedef 2605]
type    = A
movetype= A
physics = N
ctrl = 0
anim = 2605
velset = 0,0
sprpriority  = -1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1 
flag = NoShadow

[State 0, VarSet]
type = VarSet
trigger1 = !time
v = 4    ;fv = 10
value = root,var(4)

[State 0, PosSet]
type = PosSet
trigger1 = !time
x = ifelse (var(4)=0,-100,ifelse(var(4)=1,0,100))*facing

[State 0, Helper]
type = Helper
trigger1 = animelem = 3
helpertype = normal
name = "Bat Helper"  ;Bubble
ID =  2605
stateno = 2610
pos = 0,0
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S2605,0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 15
value = S2605,1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = !AnimTime

;---------------------------------------------------------------------------------------------
;PS6 - Bat helper
[Statedef 2610]
type    = A
movetype= A
physics = N
ctrl = 0
anim = 2610

[State 0, VarSet]
type = VarSet
trigger1 = !time
v = 4    ;fv = 10
value = root,var(4)

[State 0, VelSet]
type = VelSet
trigger1 = !time
x = ifelse (var(4)=0,2,ifelse(var(4)=1,1,-2))
y = 3.25

[State 0, VelAdd]
type = VelAdd
trigger1 = 1
y = -.05

[State 1050, HitOverride]
type = HitOverride
trigger1 = 1
attr = SCA, AA, AP, AT
stateno = 2611
time = -1
ignorehitpause = 1

[State 1050, NotHitBy]
type = HitBy
trigger1 = 1
value = SCA, AP; Only hit by All P types: (NP, SP, HP)
time = -1
ignorehitpause = 1

[State 1050, HitDef]
type = HitDef
trigger1 = time = 0
ID = 1050
attr = A, SP
damage = ceil(80 * root, fvar(10)), 7
animtype = Light
hitflag = MAF
guardflag = MA
priority = 4, Hit
pausetime = 1, 8
sparkno = S25010 + random % 2;0
guard.sparkno= S25008
sparkxy = -10, 0
hitsound = s8000, 2
guardsound = s8500, 0
ground.type = High
ground.hittime  = 9
ground.slidetime = 9
ground.velocity = -7
guard.hittime  = 4
guard.velocity = -15
air.type = High
air.hittime = 18
air.velocity = -4, -3.5
fall = 1
fall.recovertime = 20
envshake.time = 15
envshake.ampl = 7
fall.envshake.time = 15
fall.envshake.ampl = -7

[State 1050, ChangeState]
type = ChangeState
trigger1 = MoveContact || MoveReversed
value = 2611
ignorehitpause = 1

[State 1050, DestroySelf]
type = destroyself
trigger1 = FrontEdgeDist < -40
trigger2 = time = 160
trigger3 = BackEdgeDist < -40

;---------------------------------------------------------------------------------------------
;PS6 - Bat helper end
[Statedef 2611]
type    = A
movetype= A
physics = N
ctrl = 0
anim = 9999

[State 5150, explod]
type = Explod
trigger1 = !time
anim = 765
sprpriority = 4
postype = p1
pos = 0,0
ownpal = 1
scale = 0.5,0.5

[State 5150, pe�as]
type = Explod
trigger1 = !time
anim = 2+random%3
sprpriority = 4
postype = p1
pos = 0,-14
random = 55, 5
facing = ifelse(random<500,1,-1)
ownpal = 1
vel = 2+random%6*ifelse(random<500,1,-1),-4-random%4
accel = 0,0.25

[State 5150, pe�as]
type = Explod
trigger1 = !time
anim = 2+random%3
sprpriority = 4
postype = p1
pos = 0,-14
random = 55, 5
facing = ifelse(random<500,1,-1)
ownpal = 1
vel = 2+random%6*ifelse(random<500,1,-1),-4-random%4
accel = 0,0.25


[State 5150, pe�as]
type = Explod
trigger1 = !time && random > 500
anim = 2+random%3
sprpriority = 4
postype = p1
pos = 0,-14
random = 55, 5
facing = ifelse(random<500,1,-1)
ownpal = 1
vel = 2+random%6*ifelse(random<500,1,-1),-4-random%4
accel = 0,0.25

[State 0, DestroySelf]
type = DestroySelf
trigger1 = !AnimTime


;--------------------------------------------------
[Statedef 6050];P2 Bubble Dizzy State
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority= 3


[State 6050, ChangeAnim]
type = ChangeAnim2
trigger1 = Time = 0
value = 6035

[State 6050, Explod]
type = Explod
trigger1 = animExist (5300)
trigger1 = time = 1
anim = 5300
ID = 5300
pos = 0,-30
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = 0,0
random = 0,0
removetime = 89
supermove
pausemove
scale = .5,.5
sprpriority = 0
ontop = 0
shadow = 0,0,0
ownpal = 0
removeongethit = 1

[State 6050, Explod]
type = Explod
trigger1 = !animExist (5300)
trigger1 = time = 1
anim = 5002
ID = 5300
pos = 0,-30
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = 0,0
random = 0,0
removetime = 89
supermove
pausemove
scale = .5,.5
sprpriority = 0
ontop = 0
shadow = 0,0,0
ownpal = 0
removeongethit = 1

[State 6050, PlaySnd]
type = PlaySnd
trigger1 = time = 75
value = S12,4
channel = 2

[State 6050, ChangeState]
type = ChangeState
trigger1 = time >=90
value = 5050
ctrl = 1


;---------------------------------------------------------------------------------------------
;P02 - Boulder land
[Statedef 1622]
type    = A
movetype= A
physics = S
ctrl = 0
anim = 9999;1622
velset = 0,0

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 0, PosSet]
type = PosSet
trigger1 = !time && Pos Y >0
y = 0
ignorehitpause = 1 

[State 0, EnvShake]
type = EnvShake
trigger1 = !time
time = 15
ampl = 10

[State 0, Explod]
type = Explod
trigger1 = !time && Pos Y = 0
anim = 8012
ID = 8012
pos = 0,0
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = 0,0
random = 0,0
removetime = -2
pausemovetime = 0
scale = 1,1
sprpriority = 2
ontop = 0
shadow = 0,0,0
ownpal = 1
removeongethit = 0

[State 0, Explod]
type = Explod
trigger1 = !time && Pos Y = 0
anim = 8013
ID = 8013
pos = 0,0
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = 0,0
random = 0,0
removetime = -2
pausemovetime = 0
scale = 1,1
sprpriority = -2
ontop = 0
shadow = 0,0,0
ownpal = 1
removeongethit = 0

[State 0, Stone FX helper]
type = Helper
triggerall = NumHelper(16023) < 8
trigger1 = time <= 8
helpertype = Normal ;Player
name = "stone"
ID = 16023
stateno = 16023
pos = 0,-10
postype = P1    ;P2, Front, Back, Left, Right
facing = 1
keyctrl = 0
ownpal = 1

[State 8706 rock effect]
type = null;Explod
trigger1 = time <= 9
anim = 1623+random%5
id = 1623
pos = 0,0
postype = p1
bindtime = 1
vel = (IfElse(Random <= 499,Random/120,Random/(-120))),Random/(-120)-ifelse(random<500,5,8)
accel = 0,.5
supermovetime = 999
pausemovetime = 999
scale = 1,1;IfElse(Random <= 499,.4,.2),IfElse(Random <= 499,.4,.2)
sprpriority = 8
removetime = 120

[State 0, DestroySelf]
type = DestroySelf
trigger1 = Time = 8
;ignorehitpause = 
;persistent =

;-------------------------------------------
; Stone Helper
[StateDef 16023]
type    = A
movetype= I
physics = N
ctrl = 0
anim = 1623+random%5
sprpriority = 20

[State 0, VelSet]
type = VelSet
trigger1 = !time
x =(IfElse(Random <= 499,Random/120,Random/(-120)))
y = Random/(-120)-ifelse(random<500,5,8)

[State 0, VelAdd]
type = VelAdd
trigger1 = Pos Y < 0
y = 0.5

[State 0, VelSet]
type = VelSet
trigger1 = pos Y >= 0
x = 0
y = 0

[State 0, PosSet]
type = PosSet
trigger1 = pos Y >= 0
y = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = pos Y >= 0
value = S8100,0
persistent = 0

[State 40, Rock Land]
type = Explod
trigger1 = Pos Y >=0 ;&& Vel Y > 0
anim = 16023
sprpriority = 20
Ownpal = 1
persistent = 0

[State 0, DestroySelf]
type = DestroySelf
trigger1 = Pos Y >=0; && Vel Y > 0
trigger2 = Pos Y < -440
trigger3 = FrontEdgeDist < -40
trigger4 = BackEdgeDist < -40







;---------------------- Integer variable list ----------------------

; var(0):= 5900, -2
; var(1):= 180, 9741, 9742, 9743, 6029, 6031
; var(2):= 9741, 9742
; var(3):= 9741, 9742, 3402
; var(4):= 1400, 1410, 1450, 890, 895, 898, 9741, 9742, 1201, 1203, 1205, 1209, 6033
; var(6):= 9742
; var(7):= 9742
; var(8):= 9742, -2
; var(9):= 193, 9741, 9742, -2
;var(10):= -2, 1202, 1204, 6023
;var(11):= 7000, -2
;var(12):= 7001, -3
;var(16):= -2
;var(17):= -2
;var(20):= -2
;var(21):= -2, -3
;var(22):= 1310
;var(23):= -3
;var(25):= -2
;var(30):= 860, -1
;var(35):= 1200, 120010, -2
;var(37):= 1310
;var(38):= 1310
;var(40):= -2
;var(46):= -2
;var(50):= 193
;var(59):= 9741, 9742, -2, -1

;---------------------- Float variable list ----------------------

;fvar(10):= -2, 2320
;fvar(12):= -2
;fvar(22):= -2

